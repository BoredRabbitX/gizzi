/* ==========================================================================
   GRUPPO GIZZI - SEO & PERFORMANCE OPTIMIZATIONS
   Ottimizzazioni per search engine e performance del sito
   ========================================================================== */

/* ==========================================================================
   PERFORMANCE OPTIMIZATIONS
   ========================================================================== */

/* CSS Containment - Contain layout and paint operations */
.product-card,
.carousel-item,
.cart-item,
.modal-content {
    contain: layout style paint;
}

/* Critical CSS inlining hints */
.critical-above-fold {
    contain: layout;
}

/* Lazy loading preparation */
.lazy-load {
    opacity: 0;
    transition: opacity 0.3s ease;
}

.lazy-load.loaded {
    opacity: 1;
}

/* Content visibility for long lists */
.products-grid {
    content-visibility: auto;
    contain-intrinsic-size: 600px;
}

/* ==========================================================================
   IMAGE OPTIMIZATIONS
   ========================================================================== */

img {
    /* Enable hardware acceleration */
    transform: translateZ(0);
    /* Prevent layout shift */
    background-color: var(--gizzi-gray-100);
}

/* Modern image formats support */
picture img {
    object-fit: cover;
    font-family: 'object-fit: cover';
}

/* Image aspect ratio containers */
.aspect-ratio-4-3 {
    aspect-ratio: 4/3;
}

.aspect-ratio-16-9 {
    aspect-ratio: 16/9;
}

.aspect-ratio-1-1 {
    aspect-ratio: 1/1;
}

/* Fallback for browsers without aspect-ratio support */
@supports not (aspect-ratio: 4/3) {
    .aspect-ratio-4-3::before {
        content: '';
        display: block;
        padding-bottom: 75%;
    }
    
    .aspect-ratio-16-9::before {
        content: '';
        display: block;
        padding-bottom: 56.25%;
    }
    
    .aspect-ratio-1-1::before {
        content: '';
        display: block;
        padding-bottom: 100%;
    }
}

/* ==========================================================================
   FONT OPTIMIZATIONS
   ========================================================================== */

/* Font display strategy */
@font-face {
    font-family: 'Montserrat';
    font-display: swap;
    src: local('Montserrat'), url('fonts/montserrat.woff2') format('woff2');
}

@font-face {
    font-family: 'Fraunces';
    font-display: swap;
    src: local('Fraunces'), url('fonts/fraunces.woff2') format('woff2');
}

/* Preload critical fonts */
.font-preload {
    font-family: 'Montserrat', sans-serif;
}

/* Font size adjustments for better readability */
body {
    font-size: clamp(16px, 1.6vw, 18px);
    line-height: 1.6;
}

/* ==========================================================================
   ACCESSIBILITY ENHANCEMENTS
   ========================================================================== */

/* Skip to main content link */
.skip-link {
    position: absolute;
    top: -40px;
    left: 6px;
    background: var(--gizzi-deep);
    color: var(--gizzi-white);
    padding: 8px;
    text-decoration: none;
    border-radius: 4px;
    z-index: 10000;
    transition: top 0.3s;
}

.skip-link:focus {
    top: 6px;
}

/* Focus management */
.focusable:focus {
    outline: 3px solid var(--gizzi-gold);
    outline-offset: 2px;
}

/* Screen reader only content */
.sr-only {
    position: absolute !important;
    width: 1px !important;
    height: 1px !important;
    padding: 0 !important;
    margin: -1px !important;
    overflow: hidden !important;
    clip: rect(0, 0, 0, 0) !important;
    white-space: nowrap !important;
    border: 0 !important;
}

/* High contrast mode support */
@media (prefers-contrast: high) {
    :root {
        --gizzi-deep: #000000;
        --gizzi-gold: #ffff00;
        --text-primary: #000000;
        --text-secondary: #000000;
        --border-primary: #000000;
    }
}

/* ==========================================================================
   RESPONSIVE DESIGN ENHANCEMENTS
   ========================================================================== */

/* Mobile-first responsive utilities */
.container-responsive {
    width: 100%;
    margin: 0 auto;
    padding: 0 var(--space-4);
}

@media (min-width: 640px) {
    .container-responsive {
        padding: 0 var(--space-6);
    }
}

@media (min-width: 1024px) {
    .container-responsive {
        padding: 0 var(--space-8);
    }
}

/* Responsive typography */
.responsive-text {
    font-size: clamp(1rem, 2.5vw, 1.25rem);
}

.responsive-heading {
    font-size: clamp(1.5rem, 4vw, 2.5rem);
}

/* ==========================================================================
   SEO STRUCTURE
   ========================================================================== */

/* Semantic HTML5 structure for better SEO */
main {
    min-height: 100vh;
}

section {
    position: relative;
}

article {
    margin-bottom: var(--space-8);
}

/* Heading hierarchy */
h1 { font-size: clamp(1.875rem, 5vw, 3rem); }
h2 { font-size: clamp(1.5rem, 4vw, 2.25rem); }
h3 { font-size: clamp(1.25rem, 3vw, 1.875rem); }

/* Content structure for search engines */
.product-category {
    border-left: 4px solid var(--gizzi-gold);
    padding-left: var(--space-4);
    margin: var(--space-8) 0;
}

.product-description {
    line-height: 1.8;
    margin-bottom: var(--space-4);
}

/* ==========================================================================
   MICRODATA SUPPORT
   ========================================================================== */

/* Breadcrumb navigation */
.breadcrumb {
    list-style: none;
    padding: var(--space-4) 0;
}

.breadcrumb li {
    display: inline;
    margin-right: var(--space-2);
}

.breadcrumb li::after {
    content: '/';
    margin-left: var(--space-2);
    color: var(--text-muted);
}

.breadcrumb li:last-child::after {
    content: '';
}

/* Product schema support */
.product-price {
    font-weight: 700;
    color: var(--gizzi-gold);
}

.product-availability {
    font-size: var(--text-sm);
    color: var(--gizzi-success);
}

.in-stock::before {
    content: '✓ ';
}

.out-of-stock::before {
    content: '✗ ';
}

/* ==========================================================================
   PRINT STYLES
   ========================================================================== */

@media print {
    /* Hide non-essential elements */
    .header,
    .cart-panel,
    .modal,
    .gdpr-banner,
    .carousel-section,
    .view-controls,
    footer {
        display: none !important;
    }

    /* Optimize printed content */
    body {
        font-size: 12pt;
        line-height: 1.4;
        color: black;
        background: white;
    }

    .product-card {
        break-inside: avoid;
        border: 1pt solid black;
        margin-bottom: 1em;
    }

    /* Show URLs for links */
    a[href]:after {
        content: " (" attr(href) ")";
        font-size: 0.8em;
        color: #666;
    }

    /* Page break management */
    .section {
        page-break-before: always;
    }

    .section:first-child {
        page-break-before: auto;
    }
}

/* ==========================================================================
   PERFORMANCE MONITORING
   ========================================================================== */

/* Performance indicators */
.performance-indicator {
    position: fixed;
    bottom: 10px;
    left: 10px;
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 5px 10px;
    font-size: 12px;
    border-radius: 4px;
    z-index: 10000;
    opacity: 0;
    transition: opacity 0.3s;
}

.performance-indicator.visible {
    opacity: 1;
}

/* ==========================================================================
   ERROR HANDLING
   ========================================================================== */

/* Fallback styles for when CSS fails to load */
.no-js .header {
    position: static;
}

.no-js .cart-panel {
    position: static;
    width: 100%;
    margin-top: var(--space-4);
}

/* Error state styling */
.error-state {
    border: 2px solid var(--gizzi-danger);
    background: rgba(217, 4, 41, 0.1);
    padding: var(--space-4);
    border-radius: var(--radius-lg);
    margin: var(--space-4) 0;
}

.error-state::before {
    content: '⚠️ ';
    font-size: 1.2em;
}

/* ==========================================================================
   SECURITY ENHANCEMENTS
   ========================================================================== */

/* Prevent clickjacking */
.frame-breaker {
    display: none;
}

/* Cross-origin security */
.cross-origin-isolated {
    cross-origin-isolate: true;
}

/* ==========================================================================
   PWA PREPARATIONS
   ========================================================================== */

/* Safe area insets for mobile devices */
.safe-area-inset {
    padding-top: env(safe-area-inset-top);
    padding-right: env(safe-area-inset-right);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
}

/* Touch target sizes */
.touch-target {
    min-height: 44px;
    min-width: 44px;
}

/* ==========================================================================
   DARK MODE OPTIMIZATIONS
   ========================================================================== */

/* Optimize for OLED screens (true black) */
@media (prefers-color-scheme: dark) {
    [data-theme="dark"] {
        --bg-primary: #000000;
        --bg-secondary: #1a1a1a;
    }
}

/* Reduce blue light at night */
@media (prefers-contrast: less) and (prefers-color-scheme: dark) {
    :root {
        --gizzi-deep: #2d3748;
        --text-primary: #e2e8f0;
    }
}

/* ==========================================================================
   NETWORK ADAPTATIONS
   ========================================================================== */

/* Reduce animations on slow connections */
@media (prefers-reduced-data: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }

    .carousel-section {
        display: none;
    }

    .product-card {
        box-shadow: none;
        border: 1px solid var(--border-primary);
    }
}

/* Optimize for low bandwidth */
.saving-data {
    .product-image {
        image-rendering: pixelated;
        filter: contrast(1.2) brightness(1.1);
    }
}

/* ==========================================================================
   BROWSER COMPATIBILITY
   ========================================================================== */

/* Feature detection classes */
.css-grid .products-grid {
    display: grid;
}

.no-css-grid .products-grid {
    display: flex;
    flex-wrap: wrap;
}

.css-custom-properties .theme-toggle {
    /* Custom properties supported */
}

.no-css-custom-properties .theme-toggle {
    /* Fallback without custom properties */
    background: #f0f0f0;
}

/* ==========================================================================
   PERFORMANCE BUDGET ENFORCEMENT
   ========================================================================== */

/* Critical rendering path optimization */
.above-the-fold {
    contain: layout style;
}

.below-the-fold {
    contain: layout style paint;
    content-visibility: auto;
    contain-intrinsic-size: 500px;
}

/* CSS compression hints */
.compressible {
    will-change: auto;
}

/* ==========================================================================
   DEBUGGING STYLES
   ========================================================================== */

/* Development debugging (remove in production) */
.debug .outline {
    outline: 1px solid red;
}

.debug .grid-overlay {
    background-image: 
        linear-gradient(rgba(255, 0, 0, 0.1) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 0, 0, 0.1) 1px, transparent 1px);
    background-size: 20px 20px;
}

/* Performance visualization */
.debug .fps-counter {
    position: fixed;
    top: 10px;
    right: 10px;
    background: rgba(0, 255, 0, 0.8);
    color: black;
    padding: 5px;
    font-family: monospace;
    z-index: 10000;
}